!function(t){"use strict";t.fn.pin=function(s){var e=0,i=[],o=!1,a=t(window);s=s||{};var n=function(){for(var e=0,n=i.length;e<n;e++){var p=i[e];if(s.minWidth&&a.width()<=s.minWidth)p.parent().is(".pin-wrapper")&&p.unwrap(),p.css({width:"",left:"",top:"",position:""}),s.activeClass&&p.removeClass(s.activeClass),o=!0;else{o=!1;var r=s.containerSelector?p.closest(s.containerSelector):t(document.body),c=p.offset(),f=r.offset(),l=p.offsetParent().offset();if(p.parent().is(".pin-wrapper")||p.wrap("<div class='pin-wrapper'>"),r.height()!=p.height()){o=!1;var d=t.extend({top:0,bottom:0},s.padding||{});p.data("pin",{pad:d,from:(s.containerSelector?f.top:c.top)-d.top,to:f.top+r.height()-p.outerHeight()-d.bottom,end:f.top+r.height(),parentTop:l.top}),p.css({width:p.outerWidth()}),p.parent().css("height",p.outerHeight())}else o=!0,p.css({left:"",top:"",position:""})}}},p=function(){if(!o){e=a.scrollTop();for(var n=[],p=0,r=i.length;p<r;p++){var c=t(i[p]),f=c.data("pin");if(f){n.push(c);var l=f.from,d=f.to;l+c.outerHeight()>f.end?c.css("position",""):l<e&&d>e?(!("fixed"==c.css("position"))&&c.css({left:c.offset().left,top:f.pad.top}).css("position","fixed"),s.activeClass&&c.addClass(s.activeClass)):e>=d?(c.css({left:"",top:d-f.parentTop+f.pad.top}).css("position","absolute"),s.activeClass&&c.addClass(s.activeClass)):(c.css({position:"",top:"",left:""}),s.activeClass&&c.removeClass(s.activeClass))}}i=n}},r=function(){n(),p()};return this.each(function(){var s=t(this),e=t(this).data("pin")||{};e&&e.update||(i.push(s),t("img",this).one("load",n),e.update=r,t(this).data("pin",e))}),a.scroll(r),a.resize(function(){r()}),r(),a.load(r),this}}(jQuery);